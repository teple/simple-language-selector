name: 빌드 ~ 파일 업로드 ~ readme 다운로드 링크 갱신

# master 에 푸쉬되었을 때 실행
on:
  push:
    branches: [ master ]

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # 잡 이름은 크게 상관 없는 것 같음
  deploy:
    runs-on: ubuntu-latest
    steps:
      # 체크아웃 해서 소스를 가져옴
      - name: 코드 체크아웃
        uses: actions/checkout@v2

      # Node 모듈 캐싱 (실행속도를 빠르게)
      # -ref: https://devblog.croquis.com/ko/2020-11-06-1-using-github-actions/
      - name: Node 모듈 캐싱
        uses: actions/cache@v2
        # 아래 내용은 나중에 조사해보자 📝
        with:
          path: ~/.npm
          key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
          restore-keys: |
                        ${{ runner.os }}-node-

      # Node 14.x를 사용
      - name: 노드 14 사용
        uses: actions/setup-node@v2
        with:
          node-version: '14'

      # 의존성모듈 설치
      - name: 의존성모듈 설치
        run: npm install

      # 결과물을 빌드
      - name: 결과물을 빌드
        run: npm run build:production

      # 다음은 압축
      # Runs a set of commands using the runners shell
      - name: Run a multi-line script
        run: |
          echo Add other actions to build,
          echo test, and deploy your project.
